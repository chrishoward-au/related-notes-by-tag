/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
If you want to view the source, please visit the github repository of this plugin
*/

var E=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames;var R=Object.prototype.hasOwnProperty;var C=(s,e)=>{for(var t in e)E(s,t,{get:e[t],enumerable:!0})},L=(s,e,t,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of b(e))!R.call(s,o)&&o!==t&&E(s,o,{get:()=>e[o],enumerable:!(a=k(e,o))||a.enumerable});return s};var F=s=>L(E({},"__esModule",{value:!0}),s);var V={};C(V,{default:()=>v});module.exports=F(V);var p=require("obsidian");var w=require("obsidian"),y={exampleSetting:"default value",showTitleOnly:!1,showNotePath:!0,maxNotesPerTag:10,minTagMatchThreshold:1,excludedTags:"",prioritizedTags:"",customCssClass:"",useCompactView:!1,customSidebarTitle:"Related Notes",autoRefreshInterval:0,enableCache:!0,excludedFolders:""},u=class extends w.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Related Notes by Tag Settings"}),new w.Setting(e).setName("Example Setting").setDesc("This is an example setting for demonstration.").addText(t=>t.setPlaceholder("Enter something").setValue(this.plugin.settings.exampleSetting).onChange(async a=>{this.plugin.settings.exampleSetting=a,await this.plugin.saveSettings()})),e.createEl("p",{text:"More settings will be available in future versions."}),e.createEl("h3",{text:"Display Options (Phase 2)"}),e.createEl("h3",{text:"Filtering Options (Phase 2)"}),e.createEl("h3",{text:"Appearance Settings (Phase 2)"}),e.createEl("h3",{text:"Behaviour Settings (Phase 2)"})}};var l=require("obsidian"),r="related-notes-view",f=class extends l.ItemView{constructor(e,t){super(e),this.plugin=t}getViewType(){return r}getDisplayText(){return"Related Notes"}getIcon(){return"tag"}async onOpen(){this.container=this.contentEl,this.container.empty(),this.container.addClass("related-notes-container"),this.container.createEl("h4",{text:this.plugin.settings.customSidebarTitle||"Related Notes"}),this.updateView()}async onClose(){this.container.empty()}async updateView(){var T;if(!this.plugin.app.workspace.layoutReady)return;this.container.empty(),this.container.addClass("related-notes-container"),this.container.createEl("h4",{text:this.plugin.settings.customSidebarTitle||"Related Notes"});let e=this.app.workspace.getActiveFile();if(!e||!(e instanceof l.TFile)){this.container.createEl("p",{text:"No active note or not a markdown file."});return}let t=this.app.metadataCache.getFileCache(e);if(!t){this.container.createEl("p",{text:"Could not get file cache for the active note."});return}let a=(0,l.getAllTags)(t);if(!a||a.length===0){this.container.createEl("p",{text:"Active note has no tags."});return}let o=[...new Set(a)],N=this.app.vault.getMarkdownFiles(),h=new Map;for(let c of N){if(c.path===e.path)continue;let g=this.app.metadataCache.getFileCache(c);if(g){let n=(0,l.getAllTags)(g);if(n){let m=[...new Set(n)];for(let i of o)m.includes(i)&&(h.has(i)||h.set(i,[]),(T=h.get(i))==null||T.push(c))}}}if(h.size===0){this.container.createEl("p",{text:"No other notes found with matching tags."});return}h.forEach((c,g)=>{let n=this.container.createDiv({cls:"related-notes-tag-group collapsed"}),m=n.createEl("div",{text:`Notes with tag: ${g}`,cls:"related-notes-tag-group-header"}),i=n.createEl("ul",{cls:"related-notes-list"});i.style.display="none",m.addEventListener("click",()=>{n.toggleClass("collapsed",!n.hasClass("collapsed")),n.hasClass("collapsed")?i.style.display="none":i.style.display=""}),c.sort((d,x)=>d.basename.localeCompare(x.basename)),c.forEach(d=>{i.createEl("li",{cls:"related-notes-list-item"}).createEl("a",{text:d.basename,href:"#"}).addEventListener("click",S=>{S.preventDefault(),this.app.workspace.getLeaf("tab").openFile(d,{active:!0})})})})}};var v=class extends p.Plugin{constructor(){super(...arguments);this.view=null}async onload(){console.log("Loading Related Notes by Tag plugin"),await this.loadSettings(),this.registerView(r,t=>(this.view=new f(t,this),this.view)),(0,p.addIcon)("related-notes-icon",'<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tags"><path d="M9 5H2v7l6.29 6.29c.94.94 2.48.94 3.42 0l3.58-3.58c.94-.94.94-2.48 0-3.42L9 5Z"/><path d="M6 9.01V9"/><path d="m15 5 6.3 6.3a2.69 2.69 0 0 1 0 3.79L17.5 19a2.69 2.69 0 0 1-3.79 0L10 15.21"/></svg>'),this.addRibbonIcon("related-notes-icon","Open Related Notes Panel",()=>{this.activateView()}),this.addCommand({id:"open-related-notes-panel",name:"Open Related Notes Panel",callback:()=>{this.activateView()}}),this.addSettingTab(new u(this.app,this)),this.registerEvent(this.app.workspace.on("active-leaf-change",async()=>{this.view&&await this.view.updateView()})),this.registerEvent(this.app.metadataCache.on("changed",async t=>{this.view&&this.app.workspace.getActiveFile()===t?await this.view.updateView():this.view&&await this.view.updateView()})),this.app.workspace.onLayoutReady(async()=>{if(this.app.workspace.getActiveFile()){let a=this.app.workspace.getLeavesOfType(r)[0];a&&(this.app.workspace.revealLeaf(a),this.view&&await this.view.updateView())}}),console.log("Related Notes by Tag plugin loaded.")}onunload(){console.log("Unloading Related Notes by Tag plugin"),this.app.workspace.detachLeavesOfType(r),this.view=null}async loadSettings(){this.settings=Object.assign({},y,await this.loadData())}async saveSettings(){await this.saveData(this.settings),this.view&&await this.view.updateView()}async activateView(){let t=this.app.workspace.getLeavesOfType(r);if(t.length>0){this.app.workspace.revealLeaf(t[0]);return}let a=this.app.workspace.getRightLeaf(!1);a||(a=this.app.workspace.getRightLeaf(!0)),a?(await a.setViewState({type:r,active:!0}),this.app.workspace.revealLeaf(a)):new p.Notice("Could not open Related Notes panel: No available leaf.")}};
